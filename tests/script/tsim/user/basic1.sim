system sh/stop_dnodes.sh
system sh/deploy.sh -n dnode1 -i 1
system sh/exec.sh -n dnode1 -s start
sql connect

print =============== show users
sql show users
if $rows != 1 then 
  return -1
endi

print $data[0][0] $data[0][1] $data[0][2]
print $data[1][0] $data[1][1] $data[1][2]
print $data[2][0] $data[1][2] $data[2][2]

sql_error show accounts;
sql_error create account a pass "a"
sql_error drop account a
sql_error drop account root

print =============== create user1
sql create user user1 PASS 'user1'
sql show users
if $rows != 2 then 
  return -1
endi

print $data[0][0] $data[0][1] $data[0][2]
print $data[1][0] $data[1][1] $data[1][2]
print $data[2][0] $data[1][2] $data[2][2]
print $data[3][0] $data[3][1] $data[3][2]

print =============== create user2
sql create user user2 PASS 'user2'
sql show users
if $rows != 3 then 
  return -1
endi

print $data[0][0] $data[0][1] $data[0][2]
print $data[1][0] $data[1][1] $data[1][2]
print $data[2][0] $data[1][2] $data[2][2]
print $data[3][0] $data[3][1] $data[3][2]
print $data40 $data41 $data42

print =============== drop user1
sql drop user user1
sql show users
if $rows != 2 then 
  return -1
endi

print $data[0][0] $data[0][1] $data[0][2]
print $data[1][0] $data[1][1] $data[1][2]
print $data[2][0] $data[1][2] $data[2][2]
print $data[3][0] $data[3][1] $data[3][2]

print =============== restart taosd
system sh/exec.sh -n dnode1 -s stop
sleep 1000
system sh/exec.sh -n dnode1 -s start

print =============== show users
sql show users
if $rows != 2 then 
  return -1
endi

print $data[0][0] $data[0][1] $data[0][2]
print $data[1][0] $data[1][1] $data[1][2]
print $data[2][0] $data[1][2] $data[2][2]
print $data[3][0] $data[3][1] $data[3][2]

system sh/exec.sh -n dnode1 -s stop -x SIGINT
